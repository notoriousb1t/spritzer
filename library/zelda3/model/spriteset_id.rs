use strum_macros::Display;
use strum_macros::EnumIter;
use strum_macros::FromRepr;

const SPRITESET_UW_OFFSET: u8 = 64;

#[repr(u8)]
#[derive(Copy, Clone, Debug, Display, Eq, PartialEq, Hash, FromRepr, EnumIter, PartialOrd, Ord)]
#[allow(non_camel_case_types)]
pub(crate) enum SpritesetId {
    // Overworld Area Graphics Range 0-64
    x00_PATH = 0,
    x01_HYRULE_CASTLE_FOREST = 1,
    x02_BRIDGE = 2,
    x03_GRAVEYARD = 3,
    x04_LAKE_HYLIA = 4,
    x05_RUINS = 5,
    x06_KAKARIKO = 6,
    x07_LOST_WOODS = 7,
    x08_DESERT = 8,
    x09_KAKARIKO_LIBRARY = 9,
    x0A_PATH = 10,
    x0B_PATH = 11,
    x0C_BRIDGE = 12,
    x0D_WITCH = 13,
    x0E_ZORAS_DOMAIN = 14,
    x0F_HAUNTED_GROVE = 15,
    x10_DEATH_MOUNTAIN = 16,
    x11_HAUNTED_GROVE = 17,
    x12_POND = 18,
    x13_SKULL_WOODS = 19,
    x14_DEATHMOUNTAIN = 20,
    x15_THIEVES_VILLAGE = 21,
    x16_RUINS = 22,
    x17_RUINS = 23,
    x18_PATH = 24,
    x19_LAKE = 25,
    x1A_PATH = 26,
    xAB_DIGGING_GAME = 27,
    x1C_HYRULE_CASTLE = 28,
    x1D_THIEVES_VILLAGE = 29,
    x1E_UNUSED = 30,
    x1F_DESERT = 31,
    x20_SWAMP = 32,
    x21_UNUSED = 33,
    x22_UNUSED = 34,
    x23_PATH = 35,
    x24_UNUSED = 36,
    x25_UNUSED = 37,
    x26_PYRAMID = 38,
    x27 = 39,
    x28 = 40,
    x29 = 41,
    x2A = 42,
    x2B = 43,
    x2C = 44,
    x2D = 45,
    x2E = 46,

    x2F_FREESPACE = 47,
    x30_FREESPACE = 48,
    x31_FREESPACE = 49,
    x32_FREESPACE = 50,
    x33_FREESPACE = 51,
    x34_FREESPACE = 52,
    x35_FREESPACE = 53,
    x36_FREESPACE = 54,
    x37_FREESPACE = 55,
    x38_FREESPACE = 56,
    x39_FREESPACE = 57,
    x3A_FREESPACE = 58,
    x3B_FREESPACE = 59,
    x3C_FREESPACE = 60,
    x3D_FREESPACE = 61,
    x3E_FREESPACE = 62,
    x3F_FREESPACE = 63,
    x40_FREESPACE = 64,

    // Underworld Room Graphics Range 65-?
    x01_SEWER_AND_CAVES = 1 + SPRITESET_UW_OFFSET,
    x02_FIRST_DARK_ROOM = 2 + SPRITESET_UW_OFFSET,
    x03_THRONE_ROOM = 3 + SPRITESET_UW_OFFSET,
    x04_HYRULE_CASTLE = 4 + SPRITESET_UW_OFFSET,
    x05_SHOP = 5 + SPRITESET_UW_OFFSET,
    x06_SANCTUARY = 6 + SPRITESET_UW_OFFSET,
    x07_FAIRY_CAVE = 7 + SPRITESET_UW_OFFSET,
    x08_EASTERN_PALACE = 8 + SPRITESET_UW_OFFSET,
    x09_ARMOS = 9 + SPRITESET_UW_OFFSET,
    x0A_DESERT_PALACE = 10 + SPRITESET_UW_OFFSET,
    x0B_LANMOLAS = 11 + SPRITESET_UW_OFFSET,
    x0C_MOLDORM = 12 + SPRITESET_UW_OFFSET,
    x0D_LINKS_HOUSE = 13 + SPRITESET_UW_OFFSET,
    x0E_CHICKEN_HOUSE = 14 + SPRITESET_UW_OFFSET,
    x0F_HOUSE = 15 + SPRITESET_UW_OFFSET,
    x10_SAHASRAHLA = 16 + SPRITESET_UW_OFFSET,
    x11_SWAMP_PALACE = 17 + SPRITESET_UW_OFFSET,
    x12_MAIDENS_CHAMBER = 18 + SPRITESET_UW_OFFSET,
    x13_SKULL_WOODS_ROOM = 19 + SPRITESET_UW_OFFSET,
    x14_ARRGHUS = 20 + SPRITESET_UW_OFFSET,
    x15_HELMASAUR = 21 + SPRITESET_UW_OFFSET,
    x16_VITREOUS_KHOLDSTARE = 22 + SPRITESET_UW_OFFSET,
    x17_TURTLE_ROCK = 23 + SPRITESET_UW_OFFSET,
    x18_AGAHNIM2 = 24 + SPRITESET_UW_OFFSET,
    x19_PALACE_OF_DARKNESS = 25 + SPRITESET_UW_OFFSET,
    x1A_MOTHULA = 26 + SPRITESET_UW_OFFSET,
    x1B_BLINDS_HIDEOUT = 27 + SPRITESET_UW_OFFSET,
    x1C_ICE_PALACE = 28 + SPRITESET_UW_OFFSET,
    x1D_MISERY_MIRE = 29 + SPRITESET_UW_OFFSET,
    x1E_TURTLE_ROCK2 = 30 + SPRITESET_UW_OFFSET,
    x1F_UNUSED = 31 + SPRITESET_UW_OFFSET,
    x20_BLIND = 32 + SPRITESET_UW_OFFSET,
    x21_AGAHNIMS_TOWER = 33 + SPRITESET_UW_OFFSET,
    x22_GANON = 34 + SPRITESET_UW_OFFSET,
    x23_GANONS_TOWER1 = 35 + SPRITESET_UW_OFFSET,
    x24_GANONS_TOWER2 = 36 + SPRITESET_UW_OFFSET,
    x25_TURTLE_ROCK3 = 37 + SPRITESET_UW_OFFSET,
    x26_TURTLE_ROCK4 = 38 + SPRITESET_UW_OFFSET,
    x27_AGAHNIMS_TOWER_BRIDGE = 39 + SPRITESET_UW_OFFSET,
    x28_CHECKERBOARD_CAVE = 40 + SPRITESET_UW_OFFSET,
    X29_ICE_PALACE2 = 41 + SPRITESET_UW_OFFSET,
    x2A_HYPE_CAVE = 42 + SPRITESET_UW_OFFSET,
    x2B_PALACE_OF_DARKNESS2 = 43 + SPRITESET_UW_OFFSET,

    x2C_UNDERWORLD_FREESPACE = 44 + SPRITESET_UW_OFFSET,
    x2D_UNDERWORLD_FREESPACE = 45 + SPRITESET_UW_OFFSET,
    x2E_UNDERWORLD_FREESPACE = 46 + SPRITESET_UW_OFFSET,
    x3F_UNDERWORLD_FREESPACE = 47 + SPRITESET_UW_OFFSET,
    x30_UNDERWORLD_FREESPACE = 48 + SPRITESET_UW_OFFSET,
    x31_UNDERWORLD_FREESPACE = 49 + SPRITESET_UW_OFFSET,
    x32_UNDERWORLD_FREESPACE = 50 + SPRITESET_UW_OFFSET,
    x33_UNDERWORLD_FREESPACE = 51 + SPRITESET_UW_OFFSET,
    x34_UNDERWORLD_FREESPACE = 52 + SPRITESET_UW_OFFSET,
    x35_UNDERWORLD_FREESPACE = 53 + SPRITESET_UW_OFFSET,
    x36_UNDERWORLD_FREESPACE = 54 + SPRITESET_UW_OFFSET,
    x37_UNDERWORLD_FREESPACE = 55 + SPRITESET_UW_OFFSET,
    x38_UNDERWORLD_FREESPACE = 56 + SPRITESET_UW_OFFSET,
    x39_UNDERWORLD_FREESPACE = 57 + SPRITESET_UW_OFFSET,
    x3A_UNDERWORLD_FREESPACE = 58 + SPRITESET_UW_OFFSET,
    x3B_UNDERWORLD_FREESPACE = 59 + SPRITESET_UW_OFFSET,
    x3C_UNDERWORLD_FREESPACE = 60 + SPRITESET_UW_OFFSET,
}

impl SpritesetId {
    pub fn is_underworld(self) -> bool {
        (self as u8) > SPRITESET_UW_OFFSET
    }

    pub fn get_room_value(self) -> u8 {
        (self as u8) - SPRITESET_UW_OFFSET
    }

    pub fn from_room_value(value: u8) -> Self {
        Self::from_repr(value + SPRITESET_UW_OFFSET).unwrap()
    }
}
